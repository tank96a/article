---
title: classical reversing
author: tank96a
layout: post
categories:
  - notes
tags:
  - Reverse
---

逆向过程中的一点感悟

{% raw %}
<pre>
  一些有价值的逆向算法。
</pre>
{% endraw %}

[reversing.kr crc1](http://anch0vy.tistory.com/60)

[yyy](http://111/222/yyy.html)

{% highlight python %}
#本人修改版
# coding: utf-8
import struct
D = open("hop.exe", "rb").read()
def read(p):
    return struct.unpack("<i", D[p:p+4])[0]
offset = 0x44f491-0x4e891
start  = 0x44f491-offset
goal   = 0x4015b9-offset
E = [{start:()}]  
def print_flag(goal):
    flag=''
    p=goal
    for i in range(41,0,-1):
        t = E[i][p]
        p=t[0]
        flag += chr(t[1])                                                
    print flag[::-1]
for i in range(41):
    E += [{}]
    for p in E[i]:
        m = read(p+4)
        a = read(p+11)
        for c in range(0x20, 0x7f) if i<40 else [0]:
            t = p+read(p+m*c+a)   
            E[i+1][t]=(p, c)
print_flag(goal)

#注意这一句for c in range(0x20, 0x7f) if i<40 else [0]:可分解成下面两段代码
for i in range(40):
    E += [{}]
    for p in E[i]:
        m = read(p+4)
        a = read(p+11)
        for c in range(0x20, 0x7f):
            t = p+read(p+m*c+a)   
            E[i+1][t]=(p, c)   
E += [{}]           
for p in E[40]:
    a = read(p+11)
    t = p+read(p+a)   
    E[41][t]=(p, c)  
{% endhighlight %}

ciphertext.txt
{% raw %}
<pre>
.........
</pre>
{% endraw %}
